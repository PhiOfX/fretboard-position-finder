function navBarFretboardChords(e){for(var t=document.getElementsByClassName(e),o=0;o<t.length;o++)t[o].addEventListener("click",function(e){e.stopPropagation(),closeAllSelect(this),this.classList.toggle("active");var t=new URLSearchParams(window.location.search),o=t.get("position_select")||(document.getElementById("position_select")?document.getElementById("position_select").value:null),r=t.get("note_range")||(document.getElementById("note_range")?document.getElementById("note_range").value:null),n=Object.keys(voicing_data).filter(e=>!["chord","type","root","note_range"].includes(e));n.includes(r)||(r=n[0]),voicing_data[r]&&!Object.keys(voicing_data[r]).includes(o)&&(o=Object.keys(voicing_data[r])[0]),getTonesFromDataChords(o,r)})}function closeAllSelect(e){for(var t=document.getElementsByClassName("slit"),o=document.getElementsByClassName("sese"),r=[],n=0;n<o.length;n++)e==o[n]?r.push(n):o[n].classList.remove("slar-active");for(var n=0;n<t.length;n++)-1===r.indexOf(n)&&t[n].classList.add("sehi")}function getTonesFromDataChords(e,t){resetFretboard();var o=Object.keys(voicing_data).filter(e=>!["chord","type","root","note_range"].includes(e));for(var r in o.includes(t)||(t=o[0]),voicing_data[t]&&!Object.keys(voicing_data[t]).includes(e)&&(e=Object.keys(voicing_data[t])[0]),voicing_data[t][e][0])if(voicing_data[t][e][0].hasOwnProperty(r)){var n=voicing_data[t][e][0][r][0];if(voicing_data[t][e][0][r][2],r&&n)try{var s=r.replace(/[^a-zA-Z0-9-_]/g,""),a=n.replace(/[^a-zA-Z0-9-_]/g,""),i=document.querySelector("."+s+" img.tone."+a);i&&i.classList.add("active"),(i=document.querySelector("."+s+" .note."+a))&&i.classList.add("active")}catch(l){console.error("Invalid selector for key or tone:",s,a,l)}}for(var r in voicing_data.root)if(voicing_data.root.hasOwnProperty(r))for(var c=voicing_data.root[r],d=0;d<string_array.length;d++){var g=string_array[d].replace(/[^a-zA-Z0-9-_]/g,""),u=c.replace(/[^a-zA-Z0-9-_]/g,""),v=document.querySelector("."+g+" img.tone.active."+u);null!=v&&(v.setAttribute("src","/static/media/red_dot_24.svg"),v.classList.add("active"),v.classList.add("root"))}}function resetFretboard(){document.querySelectorAll(".active").forEach(function(e){e.classList.remove("active")})}function leftCursorClick(){var e=getQueryParam("position_select"),t=getQueryParam("note_range");null!=e&&isNaN(e)||(e="Basic Position");var o=getChordType(),r=getChordPositions(o);if(void 0===r||0===r.length){console.error("Invalid chord type or positions undefined for chord type:",o);return}var n=r.indexOf(e);-1===n&&(n=0);var s=r.length,a=(n-1+s)%s;updatePosition(r[a]),getTonesFromDataChords(r[a],t)}function rightCursorClick(){var e=getQueryParam("position_select"),t=getQueryParam("note_range");null!=e&&isNaN(e)||(e="Basic Position");var o=getChordType(),r=getChordPositions(o);if(void 0===r||0===r.length){console.error("Invalid chord type or positions undefined for chord type:",o);return}var n=r.indexOf(e);-1===n&&(n=0);var s=(n+1)%r.length;updatePosition(r[s]),getTonesFromDataChords(r[s],t)}function getQueryParam(e){return new URLSearchParams(window.location.search).get(e)}function getChordType(){return voicing_data.type}function getChordPositions(e){var t=[],o=["Basic Position","First Inversion","Second Inversion","Third Inversion"];for(var r in voicing_data)if(voicing_data.hasOwnProperty(r)&&"object"==typeof voicing_data[r])for(var n in voicing_data[r])voicing_data[r].hasOwnProperty(n)&&o.includes(n)&&!t.includes(n)&&t.push(n);return t}function updatePosition(e){var t=new URLSearchParams(window.location.search);t.set("position_select",e),window.history.replaceState(null,null,"?"+t.toString())}window.onload=function(){let e=document.getElementById("overlayMenuChords");e.style.display="none",navBarFretboardChords("sfbsfnr"),navBarFretboardChords("catsfbsf"),navBarFretboardChords("sfbsfpos"),document.addEventListener("click",closeAllSelect);var t=new URLSearchParams(window.location.search),o=t.get("position_select")||(document.getElementById("position_select")?document.getElementById("position_select").value:null),r=t.get("note_range")||(document.getElementById("note_range")?document.getElementById("note_range").value:null),n=Object.keys(voicing_data).filter(e=>!["chord","type","root","note_range"].includes(e));n.includes(r)||(r=n[0]),voicing_data[r]&&!Object.keys(voicing_data[r]).includes(o)&&(o=Object.keys(voicing_data[r])[0]),getTonesFromDataChords(o,r);var s=document.querySelector(".left-cursor"),a=document.querySelector(".right-cursor");s&&(s.style.display="block"),a&&(a.style.display="block")};const noteMapping={1:"C",3:"Db",4:"D",6:"Eb",7:"E",8:"F",10:"Gb",11:"G",13:"Ab",14:"A",16:"Bb",17:"B"},validRoots=Object.keys(noteMapping).map(Number);function changeRoot(e){var t,o=new URLSearchParams(window.location.search),r=parseInt(o.get("root"))||1,n=validRoots[(validRoots.indexOf(r)+e+validRoots.length)%validRoots.length];if(o.set("root",n),window.history.replaceState(null,null,"?"+o.toString()),o.has("position_select")){getTonesFromDataChords(o.get("position_select"),o.get("note_range")||(document.getElementById("note_range")?document.getElementById("note_range").value:null))}window.location.search=o.toString()}function increaseRoot(){changeRoot(1)}function decreaseRoot(){changeRoot(-1)}